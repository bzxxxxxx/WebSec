# level 6

```js
function escape(input) {
    // let's do a post redirection
    try {
        // pass in formURL#formDataJSON
        // e.g. http://httpbin.org/post#{"name":"Matt"}
        var segments = input.split('#');
        var formURL = segments[0];
        var formData = JSON.parse(segments[1]);

        var form = document.createElement('form');
        form.action = formURL;
        form.method = 'post';

        for (var i in formData) {
            var input = form.appendChild(document.createElement('input'));
            input.name = i;
            input.setAttribute('value', formData[i]);
        }
4
        return form.outerHTML + '                         \n\
<script>                                                  \n\
    // forbid javascript: or vbscript: and data: stuff    \n\
    if (!/script:|data:/i.test(document.forms[0].action)) \n\
        document.forms[0].submit();                       \n\
    else                                                  \n\
        document.write("Action forbidden.")               \n\
</script>                                                 \n\
        ';
    } catch (e) {
        return 'Invalid form data.';
    }
}        
```

I figured out the javascript:alert(1)#{'action':'ok'}

So as to why it works? i need to learn about DOM clobbering but still the form element afer the payload is as follows 
```html <form action="javascript:alert(1)" method="post"><input name="action" value="B"></form>```
we're filtering out anyword containing script from the form's action element so we can't use that or can we? Yes by setting input's name field as 'action' and when we call documents.forms[0].action we're getting the element ```html <input name="action" value="B"> ``` instead of the forms action attribute, ie In DOM we can reference an element by using it's name attribute. so the check is being done on this element instead of the forms action attribute hence our payload executes thus giving us the required result.

